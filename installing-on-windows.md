# Windows Setup #

## Requirements ##

  * Microsoft Visual C++ 2015 or newer (MS Build Tools also works)
  * CMake 3.4 or newer
  * git
  * Boost 1.58 or newer
  * ZeroMQ 4.2.0 or newer (if ZeroMQ support is needed)
  * MS-MPI v8 or newer (if MPI support is needed)

## Setup ##

To set up your environment:

   1. Install Microsoft Visual C++ 2015 or newer
   2. Install [Boost](http://www.boost.org/doc/libs/1_64_0/more/getting_started/windows.html) 1.58 or newer. For CMake to detect it automatically either extract Boost to the root of your drive, or set the BOOST_ROOT environment variable to the install location.
   3. *Optional* Install [ZeroMQ](http://zeromq.org/build:_start) if you need ZeroMQ support and need a copy in a global system location. We recommend skipping this step and running cmake with the `AUTOBUILD_ZMQ=ON` option to automatically set up a project-only copy of ZeroMQ later on. The ZeroMQ Windows installer is **very** outdated and will not work with new versions of Visual Studio.
   4. *Optional* Install [MS-MPI](https://msdn.microsoft.com/en-us/library/bb524831(v=vs.85).aspx) if you need MPI support.
   5. Open a Visual Studio Command Prompt, and go to your working directory.
   6. Make sure *cmake* and *git* are available in the Command Prompt. If they aren't, add them to the system PATH variable.

Getting and building from source:

   1. Set up your environment.

   2. Open a command prompt. Use git clone to check out a copy of HELICS.
   ```
   git clone https://github.com/GMLC-TDC/HELICS-src.git
   ```

   3. Go to the checkedout HELICS project folder (the default folder name is HELICS-src). Create a build folder and open the build folder. Alternatively, cmake-gui can be used.
   ```
   cd HELICS-src
   mkdir build
   cd build
   ```

   4. Run cmake. It should automatically detect where MPI is installed if the system path variables are set up correctly, otherwise you will have to set the cmake path manually. Optionally, you can use the option `-DAUTOBUILD_ZMQ=ON` to have cmake attempt to automatically download, build, and configure paths for a project-only copy of ZeroMQ.
   ```
   cmake ..
   ```

   If you need cmake to use a generator other than the default (ex: selecting between a 32-bit or 64-bit project), the -G option can be used to specify one of the generators listed by cmake --help. For Visual Studio 2017, the generator name would be `Visual Studio 15 2017 [arch]`, where [arch] is optional and can be either Win64 for a 64-bit project, or left out to generate a 32-bit project. To avoid problems when building later, this should match the version of the Boost libraries you are using.

   If you installed boost into the root of the C or D drives with the default name (or the BOOST_ROOT environment variable has been set), cmake should automatically detect their location. Otherwise the location will need to be manually given to cmake.

   5. Open the Visual Studio solution generated by CMake. Under the *Build* menu, select *Build the Solution*. Alternatively, in the MSBuild command prompt, run the command `msbuild HELICS.sln` from the build folder to compile the entire solution. HELICS.sln can be replaced with the name of one of the projects to build only that part of HELICS.

## Testing

A quick test is to double check the versions of the HELICS player and recorder (located in the build\src\helics\player\Debug folder):

```bash
cd C:\Path\To\build\src\helics\player\Debug

> helics_player.exe --version
0.1

> helics_recorder.exe --version
0.1
```

See the `/examples/README.md` for additional examples to try.
